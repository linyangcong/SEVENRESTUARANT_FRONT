(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/myDetail/login/login"],{"26f7":function(e,t,o){},"4bf2":function(e,t,o){"use strict";var n,s=function(){var e=this,t=e.$createElement,o=(e._self._c,e._f("getRole")(e.roleId)),n=e._f("getRole")(e.roleId);e.$mp.data=Object.assign({},{$root:{f0:o,f1:n}})},r=[];o.d(t,"b",(function(){return s})),o.d(t,"c",(function(){return r})),o.d(t,"a",(function(){return n}))},"892e":function(e,t,o){"use strict";(function(e){o("3a1f");n(o("66fd"));var t=n(o("e4b7"));function n(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,o("543d")["createPage"])},b6ab:function(e,t,o){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=s(o("eab1"));function s(e){return e&&e.__esModule?e:{default:e}}function r(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function i(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?r(Object(o),!0).forEach((function(t){a(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):r(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function a(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}var l={data:function(){return{orderId:"",config:n.default,loginflag:"0",username:"",loginname:"",password:"",roleId:"01",provider:""}},methods:{goWXlogin:function(){var t=this;void 0==this.provider?e.showToast({title:"该平台不支持微信登录",icon:"none"}):e.login({provider:this.provider,success:function(o){o.code?e.getUserInfo({provider:t.provider,lang:"zh_CN",success:function(s){e.request({url:n.default.server+"/getWXSession",method:"POST",data:{js_code:o.code,grant_type:"authorization_caode",appid:n.default.appid,secret:n.default.secret,signature:s.signature,rawData:s.rawData},success:function(o){console.log(s.userInfo),console.log(o.data),o.data.status?(t.password=o.data.reuslt.openid,t.loginname=s.userInfo.nickName,o.data.flag?e.request({url:n.default.server+"/register",data:{loginname:s.userInfo.nickName,password:o.data.reuslt.openid,roleId:t.roleId,username:s.userInfo.nickName,wxflag:"02"},method:"POST",success:function(e){t.gologin()}}):t.gologin(),t.$store.dispatch("setOpenId",o.data.reuslt.openid),t.$store.dispatch("setSessionKey",o.data.reuslt.session_key)):e.showToast({title:"微信登录失败",icon:"none"})},fail:function(e){console.log(e)}})},fail:function(t){e.showToast({title:"获取验证信息失败",icon:"none"})}}):e.showToast({title:"获取登录态失败",icon:"none"})},fail:function(t){e.showToast({title:"登录失败"+err,icon:"none"})}})},getProvider:function(){var t=this;e.getProvider({service:"oauth",success:function(e){console.log(e.provider[0]),0!==e.provider.length&&(t.provider=e.provider[0])}})},godefaullogin:function(){this.loginflag="3"},seeOrderId:function(){var t=this;e.request({url:n.default.server+"/getdetailLists?orderId="+this.orderId,success:function(o){if(console.log(o.data),200==o.statusCode){var n="../../index/seeMap/seeMap";"t"==t.loginpage&&(n="./seeMap/seeMap"),e.navigateTo({url:n+"?orderId="+t.orderId})}else 404==o.statusCode&&e.showToast({title:"订单不存在",icon:"none"})}})},goback:function(){this.username="",this.loginname="",this.password="",this.roleId="01",this.loginflag="0",this.orderId=""},goselectRole:function(){var t=this;e.showActionSheet({itemList:["普通用户","商家","骑手"],itemColor:"#007AFF",success:function(e){0==e.tapIndex&&(t.roleId="01"),1==e.tapIndex&&(t.roleId="02"),2==e.tapIndex&&(t.roleId="03")}})},gologin:function(){var t=this;console.log(this.loginname,this.password),e.request({url:n.default.server+"/login",method:"POST",data:{loginname:this.loginname,password:this.password,roleId:this.roleId},success:function(o){200==o.statusCode?(void 0==o.data.result.def_address?t.$store.dispatch("setUser",i({},o.data.result,{def_address:{phoneNo:"",address:""}})):t.$store.dispatch("setUser",o.data.result),console.log(o),e.showToast({title:"微信登录成功",icon:"none"}),e.navigateBack({})):404==o.statusCode&&e.showToast({title:"角色，账号或密码错误",icon:"none"})}})},forgotPass:function(){e.showToast({title:"暂未开通",icon:"none"})},goRegister:function(){this.loginname="",this.password="",this.roleId="01",this.loginflag="1"},Register:function(){var t=this;e.request({url:n.default.server+"/register",data:{loginname:this.loginname,username:this.username,password:this.password,roleId:this.roleId,wxflag:"01"},method:"POST",success:function(o){if(200==o.statusCode)console.log(o.data),e.showToast({title:"注册成功",icon:"none"}),t.goback();else if(500==o.statusCode)return void e.showToast({title:"该角色账号已被注册",icon:"none"})}})}},props:["loginpage"],filters:{getRole:function(e){return"01"==e?"普通用户":"02"==e?"商家":"03"==e?"骑手":void 0}},onShow:function(){this.getProvider()}};t.default=l}).call(this,o("543d")["default"])},e4b7:function(e,t,o){"use strict";o.r(t);var n=o("4bf2"),s=o("ebcb");for(var r in s)"default"!==r&&function(e){o.d(t,e,(function(){return s[e]}))}(r);o("fc20");var i,a=o("f0c5"),l=Object(a["a"])(s["default"],n["b"],n["c"],!1,null,"6528b070",null,!1,n["a"],i);t["default"]=l.exports},ebcb:function(e,t,o){"use strict";o.r(t);var n=o("b6ab"),s=o.n(n);for(var r in n)"default"!==r&&function(e){o.d(t,e,(function(){return n[e]}))}(r);t["default"]=s.a},fc20:function(e,t,o){"use strict";var n=o("26f7"),s=o.n(n);s.a}},[["892e","common/runtime","common/vendor"]]]);